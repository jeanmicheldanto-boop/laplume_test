# RÈGLES EXTERNES — Pseudonymisation (regex)
# ------------------------------------------------------------
# NOTE: toutes les catégories ORG doivent être sous `org_regex:`

org_regex:

  # --- Socle social territorial / institutions locales ---
  ORG_CCAS_CIAS:
    - "\\bCCAS\\b"
    - "\\bCIAS\\b"

  ORG_SIAO:
    - "\\bSIAO\\b"

  ORG_DEPARTEMENT:
    - "\\bConseil\\s+[Dd]épartemental\\b"
    - "\\bConseil\\s+Départemental\\b"
    - "\\bDépartement\\s+(?:du|de\\s+la|des|de)\\b"

  ORG_REGION:
    - "\\bConseil\\s+régional\\b"
    - "\\bRégion\\b"

  ORG_PREFECTURE:
    - "\\bPréfecture\\b"
    - "\\bSous[-\\s]?préfecture\\b"

  # Justice (évite que "TJ Bobigny" parte en LOC)
  ORG_JUSTICE:
    - "\\bTJ\\s+[A-ZÉ][\\w''\\-]+\\b"
    - "\\bTGI\\s+[A-ZÉ][\\w''\\-]+\\b"
    - "\\bTribunal\\s+(?:Judiciaire|de\\s+Grande\\s+Instance)\\b"

  ORG_DDETS:
    - "\\bDDETS(?:PP)?\\b"
    - "\\bDirection\\s+d[’'](?:l’)?emploi\\b"

  ORG_ARS:
    - "\\bARS\\b"
    - "\\bAgence\\s+Régionale\\s+de\\s+Santé\\b"

  ORG_ASE:
    - "\\bASE\\b"
    - "\\bAide\\s+Sociale\\s+à\\s+l[’']Enfance\\b"

  ORG_PJJ:
    - "\\bPJJ\\b"
    - "\\bProtection\\s+Judiciaire\\s+de\\s+la\\s+Jeunesse\\b"

  ORG_MDPH:
    - "\\bMDPH\\b"
    - "\\bMaison\\s+Départementale\\s+des\\s+Personnes\\s+Handicapées\\b"

  ORG_PMI:
    - "\\bPMI\\b"
    - "\\bProtection\\s+Maternelle\\s+et\\s+Infantile\\b"

  # --- Sécurité sociale / emploi ---
  ORG_CAF:
    - "\\bCaisse\\s+d[’']Allocations\\s+Familiales\\b"
    - "\\bCAF\\b"

  ORG_CPAM:
    - "\\bCaisse\\s+Primaire\\s+d[’']Assurance\\s+Maladie\\b"
    - "\\bCPAM\\b"

  ORG_URSSAF:
    - "\\bURSSAF\\b"

  ORG_MSA:
    - "\\bMSA\\b"
    - "\\bMutualité\\s+Sociale\\s+Agricole\\b"

  ORG_CARSAT:
    - "\\bCARSAT\\b"

  ORG_CNAV:
    - "\\bCNAV\\b"
    - "\\bCaisse\\s+Nationale\\s+d[’']Assurance\\s+Vieillesse\\b"

  ORG_POLE_EMPLOI:
    - "\\bPôle\\s+emploi\\b"

  ORG_AGIRC_ARRCO:
    - "\\bAGIRC[-\\s]?ARRCO\\b"

  # --- Santé / médico-psy / addictions / accueil ---
  ORG_CHU_CH:
    - "\\bCHU\\b"
    - "\\bCentre\\s+Hospitalier\\b"
    - "\\bCHR\\b"
    # variantes explicites "CHU/Centre hospitalier <Ville>"
    - "\\bCHU\\s+(?:de\\s+)?[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\-]+(?:\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\-]+){0,2}\\b"
    - "\\b(?:Centre\\s+Hospitalier|CHR)\\s+(?:de\\s+)?[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\-]+(?:\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\-]+){0,2}\\b"
    # hôpitaux nominatifs (ex: Hôpital Cochin, La Timone…)
    - "\\bHôpit(?:al|aux)\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\-]+(?:\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\-]+){0,3}\\b"

  ORG_EPSM:
    - "\\bEPSM\\b"
    - "\\bÉtablissement\\s+Public\\s+de\\s+Santé\\s+Mentale\\b"

  ORG_CMP:
    - "\\bCMP\\b"
    - "\\bCentre\\s+Médico\\s+Psychologique\\b"

  ORG_CMPP:
    - "\\bCMPP\\b"
    - "\\bCentre\\s+Médico\\s+Psycho\\s+Pédagogique\\b"

  ORG_CATTP:
    - "\\bCATTP\\b"
    - "\\bCentre\\s+d’Accueil\\s+Thérapeutique\\s+à\\s+Temps\\s+Partiel\\b"

  ORG_CSAPA:
    - "\\bCSAPA\\b"
    - "\\bCentre\\s+de\\s+Soin\\s+d’Accompagnement\\s+et\\s+de\\s+Prévention\\s+en\\s+Addictologie\\b"

  ORG_CAARUD:
    - "\\bCAARUD\\b"
    - "\\bCentre\\s+d’Accueil\\s+et\\s+d’Accompagnement\\s+à\\s+la\\s+Réduction\\s+des\\s+Risques\\b"

  ORG_PASS:
    - "\\bPASS\\b"
    - "\\bPermanence\\s+d’Accès\\s+aux\\s+Soins\\s+de\\s+Santé\\b"

  ORG_MDA:
    - "\\bMDA\\b"
    - "\\bMaison\\s+des\\s+Adolescents\\b"

  ORG_CAMSP:
    - "\\bCAMSP\\b"
    - "\\bCentre\\s+d[’']Action\\s+Médico\\s+Sociale\\s+Précoce\\b"

  # --- Hébergement / asile / insertion ---
  ORG_CHRS:
    - "\\bCHRS\\b"
    - "\\bCentre\\s+d[’']Hébergement\\s+et\\s+de\\s+Réinsertion\\s+Sociale\\b"

  ORG_CADA:
    - "\\bCADA\\b"
    - "\\bCentre\\s+d[’']Accueil\\s+de\\s+Demandeurs\\s+d[’']Asile\\b"

  ORG_HUDA:
    - "\\bHUDA\\b"
    - "\\bHébergement\\s+d[’']Urgence\\s+pour\\s+Demandeurs\\s+d[’']Asile\\b"

  ORG_PRAHDA:
    - "\\bPRAHDA\\b"

  ORG_CAO:
    - "\\bCAO\\b"
    - "\\bCentre\\s+d[’']Accueil\\s+et\\s+d[’']Orientation\\b"

  # --- Insertion socio-pro locale ---
  ORG_MISSION_LOCALE:
    - "\\bMission\\s+Locale\\b"
    - "\\bMission\\s+Locale\\s+(?:de|du|d’|d')\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\- ]+\\b"
    - "\\bMaison\\s+de\\s+l[’']Emploi\\b"

  # --- Services d'aide à domicile (organismes) ---
  ORG_SAD:
    - "\\bADMR\\b"
    - "\\bService\\s+d['’]Aide\\s+à\\s+Domicile\\b"
    - "\\bService\\s+d['’]Aide\\s+et\\s+d['’]Accompagnement\\s+à\\s+Domicile\\b"
    - "\\bAide\\s+à\\s+Domicile\\b"
    - "\\bServices?\\s+à\\s+la\\s+personne\\b"

  # --- Bailleurs sociaux / logement ---
  ORG_BAILLEUR_SOC:
    - "\\bOPH(?:\\s+de\\s+[A-ZÉ][A-Za-zÀ-ÖØ-öø-ÿ’'\\- ]+)?\\b"
    - "\\bOPAC\\b"
    - "\\bOPHLM\\b"
    - "\\b(?:Office|Offices?)\\s+Public(?:s)?\\s+d['’]Habitat\\b"
    - "\\bESH\\b"
    - "\\bS(?:A|A\\.?)\\s*HLM\\b"
    - "\\bCDC\\s+Habitat\\b"
    - "\\bHabitat\\s+\\d{2}\\b"
    - "\\bHabitat\\s+[A-ZÉ][A-Za-zÀ-ÖØ-öø-ÿ’'\\- ]+\\b"
    - "\\bHLM\\b"

  # --- Entreprises (utile pour employeurs) ---
  ORG_ENTREPRISE_PRIV:
    - "\\bCarrefour\\b|\\bAuchan\\b|\\bLeclerc\\b|\\bCasino\\b|\\bMonoprix\\b|\\bFranprix\\b|\\bIntermarché\\b"

  ORG_FINANCIER:
    - "\\bBanque\\s+(?:Populaire|Postale|Palatine|Tarneaud|Courtois|\\w+)\\b"
    - "\\bCrédit\\s+(?:Mutuel|Agricole|Coopératif)\\b"
    - "\\bSociété\\s+Générale\\b"
    - "\\bBNP\\s+Paribas\\b"
    - "\\bCofidis\\b|\\bCetelem\\b|\\bOney\\b|\\bFloabank\\b"

  # --- Grandes associations / fondations nationales ---
  ORG_CROIX_ROUGE:
    - "\\bCroix[-\\s]Rouge\\s+française\\b"

  ORG_EMMAUS:
    - "\\bEmma[üu]s\\b"

  ORG_SECOURS_POP:
    - "\\bSecours\\s+Populaire\\b"

  ORG_SECOURS_CATHO:
    - "\\bSecours\\s+Catholique\\b"
    - "\\bCaritas\\b"

  ORG_FONDATION_ABBE_PIERRE:
    - "\\bFondation\\s+Abbé\\s+Pierre\\b"

  ORG_ARMEE_SALUT:
    - "\\bArmée\\s+du\\s+Salut\\b"

  ORG_APF:
    - "\\bAPF\\s+France\\s+handicap\\b"

  ORG_UNAPEI:
    - "\\bUNAPEI\\b|\\bADAPEI\\b|\\bAPEI\\b"

  ORG_ASEI:
    - "\\bASEI\\b"
    - "\\bAssociation\\s+au\\s+Service\\s+de\\s+l[’']Enfance\\s+Inadaptée\\b"

  ORG_APAJH:
    - "\\bAPAJH\\b"

  ORG_AFM_TELETHON:
    - "\\bAFM\\s+Téléthon\\b"

  # Sauvegarde (départementalisée) — ex: "Sauvegarde 44", "Sauvegarde de l'Enfance ..."
  ORG_SAUVEGARDE:
    - "\\bSauvegarde\\s+(?:\\d{2}|de\\s+l[’']Enfance|de\\s+[A-ZÉ][A-Za-zÀ-ÖØ-öø-ÿ’'\\- ]+)\\b"

  # --- Associations / fondations génériques (locales) ---
  ORG_ASSOC_GENERIC:
    - "\\bAssociation\\b"
    - "\\bAsso\\.?\\b"
    - "\\bSolidarité\\b"
    - "\\bInsertion\\b"
    - "\\bRelais\\s+Insertion\\s+\\d{2}\\b"
    - "\\bMosaïque\\s+Service\\s+Social\\b"
    # Cas SOS Villages d'Enfants
    - "\\bVillage\\s+d[’']?Enfants\\s+SOS\\b"
    - "\\bSOS\\s+Villages?\\s+d[’']?Enfants\\b"
    - "\\bVillage\\s+Enfants\\s+SOS\\b"
    - "\\bEnfants\\s+SOS\\b"
    - "\\bLa\\s+Sauvegarde\\b"

  ORG_FONDATION_GENERIC:
    - "\\bFondation\\b"
    - "\\bŒuvre\\b|\\bOeuvre\\b"

# ----------------------------------------------------------------
# ÉTABLISSEMENTS ESSMS (catégories — produisent <ETAB_...>)
# ----------------------------------------------------------------
etab_categories:

  # Personnes âgées
  EHPAD:
    - "\\bEHPAD\\b"
    - "\\bRésidence\\s+Médicalisée\\b"
  RES_AUTONOMIE:
    - "\\bRésidence(?:s)?\\s+autonomie\\b"
    - "\\bFoyer(?:-|\\s)?logement\\b"
  ACCUEIL_JOUR_ALZHEIMER:
    - "\\bAccueil\\s+de\\s+jour\\s+Alzheimer\\b"
    - "\\bAccueil\\s+de\\s+jour\\b"

  # Handicap (adultes/enfants)
  MAS:
    - "\\bMAS\\b"
    - "\\bMaison\\s+d[’']Accueil\\s+Spécialisée\\b"
  FAM:
    - "\\bFAM\\b"
    - "\\bFoyer\\s+d[’']Accueil\\s+Médicalisé\\b"
  FOYER_VIE:
    - "\\bFoyer(?:s)?\\s+de\\s+vie\\b"
  FOYER_HEBERGEMENT:
    - "\\bFoyer\\s+d[’']Héberg(?:e)?ment\\b"
  ESMS_EANM:
    - "\\bEANM\\b"
    - "\\bÉtablissement\\s+d[’']Accueil\\s+Non\\s+Médicalisé\\b"
  ESAT:
    - "\\bESAT\\b|\\bÉSAT\\b"
    - "\\bÉtablissement\\s+et\\s+Service\\s+d['’]Aide\\s+par\\s+le\\s+Travail\\b"
  EA:
    - "\\bEA\\b|\\bEntreprise\\s+Adaptée\\b"
  SAVS:
    - "\\bSAVS\\b"
  SAMSAH:
    - "\\bSAMSAH\\b"
  SSIAD:
    - "\\bSSIAD\\b"
  SPASAD:
    - "\\bSPASAD\\b"
  SAAD:
    - "\\bSAD\\b|\\bSAAD\\b"
  PCPE:
    - "\\bPCPE\\b"

  # Enfance / éducation spécialisée
  MECS:
    - "\\bMECS\\b"
    - "\\bMaison\\s+d[’']Enfants\\s+à\\s+Caractère\\s+Social\\b"
  ITEP:
    - "\\bI?D?ITEP\\b"
  IME:
    - "\\bIME\\b"
  IMPRO:
    - "\\bIMPRO\\b"
  IEM:
    - "\\bIEM\\b"
  IES:
    - "\\bIES\\b|\\bInstitut\\s+d['’]Éducation\\s+Sensorielle\\b"
  SESSAD:
    - "\\bSESSAD\\b"
  SAFEP:
    - "\\bSAFEP\\b"
  SSEFS:
    - "\\bSSEFS\\b"
  EEAP:
    - "\\bEEAP\\b"
  UEMA_UEMI_UEEA:
    - "\\bUEMA\\b|\\bUEMI\\b|\\bUEEA\\b"
  GEM:
    - "\\bGEM\\b|\\bGroupe\\s+d[’']Entraide\\s+Mutuelle\\b"

  # Sanitaire / médico-psy rattaché
  CHU_CH:
    - "\\bCHU\\b|\\bCentre\\s+Hospitalier\\b"
  EPSM:
    - "\\bEPSM\\b"
  CMP:
    - "\\bCMP\\b|\\bCentre\\s+Médico\\s+Psychologique\\b"
  CMPP:
    - "\\bCMPP\\b"
  CATTP:
    - "\\bCATTP\\b"
  CSAPA:
    - "\\bCSAPA\\b"
  CAARUD:
    - "\\bCAARUD\\b"
  PASS:
    - "\\bPASS\\b"
  CAMSP:
    - "\\bCAMSP\\b"
  PCO:
    - "\\bPlateforme\\s+de\\s+Coordination\\s+et\\s+d[’']Orientation\\b"
  HAD:
    - "\\bHAD\\b"

  # Jeunes travailleurs
  FJT:
    - "\\bFJT\\b"
    - "\\bFoyer\\s+(?:de\\s+)?Jeunes?\\s+Travailleur[s]?\\b"
    - "\\bRésidence\\s+Jeunes\\s+Travailleurs\\b"

  # Établissements scolaires (nouveau)
  ETAB_SCOLAIRE:
    - "\\bÉcole\\s+[A-ZÉ][\\w’'\\-]+(?:\\s+[A-ZÉ][\\w’'\\-]+){0,3}\\b"
    - "\\bCollège\\s+[A-ZÉ][\\w’'\\-]+(?:\\s+[A-ZÉ][\\w’'\\-]+){0,3}\\b"
    - "\\bLycée\\s+[A-ZÉ][\\w’'\\-]+(?:\\s+[A-ZÉ][\\w’'\\-]+){0,3}\\b"

  # Établissements génériques nommés (poétiques)
  ETAB_GENERIC:
    - "\\b(?:Les|La|Le)\\s+(?:Arc-en-Ciel|Horizon|Orée\\s+des\\s+Bois|Autonomie\\s+Sud|Pré\\s+Vert|Val\\s+Fleuri|Tilleuls|Primevères|Acacias)\\b"

# ----------------------------------------------------------------
# PATRONS GÉNÉRIQUES
# ----------------------------------------------------------------
patterns:
  # indice de localité "à/au/aux/dans/sur <Ville>"
  loc_hint: "\\b(?:à|à\\s+la|à\\s+l['’]|au|aux|dans|sur)\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w\\-'’]+"

  # stop-mots (évite de taguer en LOC des mots génériques isolés)
  loc_stopwords:
    - "\\b(?:avenue|av\\.?|rue|boulevard|bd|impasse|allée|chemin|quai|cours|place|secteur|du|de|des|de\\s+la|de\\s+l’|d’|Jean\\-|Jean|Saint|Sainte)\\b"

  # extraction d'un intitulé (borne pour ne PAS avaler ce qui suit)
  etab_name_window: >
    (?:
      «|\\"|"
    )?
    (
      [A-ZÉÈÀÂÎÙÔÇ][\\w’'-]+
      (?:
        \\s+(?:de|du|des|d'|d’)?\\s*[A-ZÉÈÀÂÎÙÔÇ][\\w’'-]+
      ){0,4}
    )
    (?:
      »|\\"|"
    )?
    (?=
      [\\s\\.,;:\\)\\]]|
      \\s+(?:à|au|aux|chez|pour|avec|dans|sur|le|la|les|de|des|du|d’|d')|
      \\s+\\d|
      \\s*<
    )

  # nom propre d'établissement sans guillemets (Les/La/Le + Nom)
  etab_det_nomp: "\\b(?:Les|La|Le)\\s+[A-Z][\\w’'\\-]+(?:\\s+[A-Z][\\w’'\\-]+){0,3}\\b"

  # nom propre suivi d'un type d'établissement entre parenthèses
  etab_name_then_type: "\\b(?:Les|La|Le)\\s+[A-Z][\\w’'\\-]+(?:\\s+[A-Z][\\w’'\\-]+){0,3}\\s*\\((?:EHPAD|IME|ITEP|MECS|ESAT|FAM|MAS|FJT)\\)\\b"

  # type d'établissement suivi d'un nom propre (avec ville optionnelle)
  type_then_etab_name: "\\b(?:EHPAD|IME|I?D?ITEP|IES|MECS|ESAT|FAM|MAS|FJT)\\s+(?:Les|La|Le)?\\s*[A-Z][\\w’'\\-]+(?:\\s+[A-Z][\\w’'\\-]+){0,3}(?:\\s+[A-ZÉ][\\w’'\\-]+){0,2}\\b"

# ----------------------------------------------------------------
# ADRESSES (full vs. rue/voie)
# ----------------------------------------------------------------
address_regex:
  ADDR_FULL:
    # n°, voie, libellé, CP (4-5 chiffres), ville (quelques mots)
    - "\\b\\d{1,3}\\s*(?:bis|ter|quater)?\\s+(?:avenue|av\\.?|boulevard|bd|rue|impasse|allée|chemin|quai|cours|route)\\s+[A-ZÉÈÀÂÎÙÔÇ0-9][\\w’'\\- ]{1,80}?\\s+\\d{4,5}\\b\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\- ]{1,60}\\b"
    # voie sans numéro mais avec CP+ville
    - "\\b(?:avenue|av\\.?|boulevard|bd|rue|impasse|allée|chemin|quai|cours|route)\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\- ]{1,80}?\\s+\\d{4,5}\\b\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\- ]{1,60}\\b"
  ADDR_STREET:
    # n° + voie + libellé (sans CP/ville obligatoire)
    - "\\b\\d{1,3}\\s*(?:bis|ter|quater)?\\s+(?:avenue|av\\.?|boulevard|bd|rue|impasse|allée|chemin|quai|cours|route)\\s+[A-ZÉÈÀÂÎÙÔÇ0-9][\\w’'\\- ]{1,80}\\b"
    # voie + libellé (sans numéro)
    - "\\b(?:avenue|av\\.?|boulevard|bd|rue|impasse|allée|chemin|quai|cours|route)\\s+[A-ZÉÈÀÂÎÙÔÇ][\\w’'\\- ]{1,80}\\b"

# ----------------------------------------------------------------
# DONNÉES SENSIBLES SPÉCIFIQUES
# ----------------------------------------------------------------
date_regex:
  DATE:
    - "\\b(?:0[1-9]|[12][0-9]|3[01])[./](?:0[1-9]|1[0-2])[./](?:19|20)\\d{2}\\b"
    - "\\b(?:0[1-9]|[12][0-9]|3[01])-(?:0[1-9]|1[0-2])-(?:19|20)\\d{2}\\b"
    - "\\b(?:19|20)\\d{2}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12][0-9]|3[01])\\b"

phone_regex:
  PHONE:
    - "\\b(?:0[1-9])(?:[.]\\d{2}){4}\\b"
    - "\\b(?:0[1-9])(?:-\\d{2}){4}\\b"
    - "\\b(?:0[1-9])(?:\\s\\d{2}){4}\\b"
    - "\\b(?:0[1-9])\\d{8}\\b"

nir_regex:
  NIR:
    - "\\b\\d{13}\\b"

time_regex:
  TIME:
    - "\\b(?:[01]?\\d|2[0-3])h(?:[0-5]\\d)?\\b"
    - "\\b(?:[01]?\\d|2[0-3]):(?:[0-5]\\d)\\b"

# ----------------------------------------------------------------
# PROFESSIONS ET FONCTIONS
# ----------------------------------------------------------------
profession_regex:
  PROFESSION:
    - "\\b(Conseillèr(e)?|Assistante\\s+sociale|Éducateur(rice)?\\s+(?:spécialisé|jeunes\\s+enfants)|Psychologue|Ergothérapeute|Orthophoniste|Infirmièr(e)?|Médecin|Directeur(rice)?|Chef\\s+de\\s+service)\\b"
    - "\\bCESF\\b"
    - "\\bAS\\b(?!\\s+de)"
    - "\\bAMP\\b"
    - "\\bAES\\b"

email_regex:
  EMAIL:
    - "\\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\\b"
